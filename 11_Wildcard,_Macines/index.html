<!DOCTYPE html>
<html lang="en">

<title>PHYS-S-12: INTRO TO DIGITAL FABRICATION - ABI ADAM </title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../style.css" rel="stylesheet">

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<body>


<xmp theme="journal" style="display:none;">



  # Week 11: Wildcard, Machines

The assignment this week was to document process on my final project- here it is: 

  ## Circuits:

  Here are images of the iterations of the piano thus far: 

  1. One pin used for output, and there are multiple breadboard all lying in the same plane.

  <img src="IMG_6162.jpeg" alt="circuit1pic" style="width:301.1px;height:402.1px;">

  2. 2 pins for output (so it can play multiple notes at once), and the breadboards are stacked to fit dimensions of container

  <img src="IMG_6300.jpeg" alt="circuit2pic" style="width:301.4px;height:401.9px;">

  3. There are mini breadboards for the buttons, and a large one for the associated wiring. It still has the two output pins to allow for the playing of two notes at once. At this point, it's just held together by clay so I can assemble and dissasemble it at will.

<img src="IMG_6313-1.jpeg" alt="circuit3pic" style="width:301.2px;height:401.9px;">

  4. I laser cut the keys and overhang and attached them to the rest of the piano using hot glue. The keys and overhang are attached to the body of the piano with hinges to allow easy access to the wiring. 

<img src="IMG_6321.jpeg" alt="circuit4pic" style="width:301.8px;height:401.5px;">
<img src="IMG_6336.jpeg" alt="circuit4pic" style="width:401.6px;height:300.5px;">

The fifth iteration, created after all the code and wiring is finalized, will include sidings to enclose the breadboard. 

## Code: 

Here is the most up to date code for the project as of July 27th. There are still various bugs in it that I am working on solving, such as getting it to stop playing the second of two notes played simultaneously once the button is released. 

I'm also working on getting prgram interrupts to work so that the buzzer will respond faster to the buttons being pressed. 
<pre><code class="language-arduino">

// Author: Abi Adam

class Button {
 // Class Member Variables
 // These are initialized at startup
  int buttonPin;  // the number of the pin
  long frequency; // the frequency 
  int playTime; // the amount of time the buzzer will play after the button is pressed 

  // These maintain the current state
  int buzzerState;   // buzzerState used to set the buzzer
 
  // Constructor - creates a Button and initializes the member variables and state
  public:
  Button(int pin, long freq, int time_){
  buttonPin = pin;
  pinMode(buttonPin, INPUT);  
  
  frequency = freq; 
  playTime = time_; 

  buzzerState = LOW; 
  }

  void playNoise(int buttonPin, int buzzerPin, int frequency, int playTime){ 

  int buttonState = 0;
  buttonState = digitalRead(buttonPin); // read new state

  if (buttonState == HIGH) {
    Serial.println("The button is being pressed");
     myTone(buzzerPin, frequency, playTime);  // turn on
  }
  else
  if (buttonState == LOW) {
    Serial.println("The button is unpressed");
    myTone(buzzerPin, 0, 5);  // turn off
  }
}

///////////////////////////////////////////////////////////////////////////////////////////////////

void myTone(int pin, int frequency, int duration){ 
    int startTime = millis();
    int period = 1000000/frequency; 
    while ((millis() - startTime) < duration){ 
        digitalWrite(pin, LOW);
        delayMicroseconds(period/2);
        digitalWrite(pin, HIGH); //reversed high and low in this while-- change back if this causes problems
        delayMicroseconds(period/2);
    }
}

}; //end of Button class

///////////////////////////////////////////////////////////////////////////////////////////////////
        
void playChord(int chordN1, int chordN2){ 

  while (digitalRead(chordN1) == HIGH && digitalRead(chordN2) == HIGH){
    Serial.println("Playing note 1!");
      if (chordN1 == 1){ analogWrite(10, 262); }
      else if (chordN1 == 2){  analogWrite(10, 294); }
      else if (chordN1 == 3){  analogWrite(10, 330); }
      else if (chordN1 == 4){  analogWrite(10, 349); }
      else if (chordN1 == 5){  analogWrite(10, 392); }
      else if (chordN1 == 6){  analogWrite(10, 493); }
      else if (chordN1 == 8){  analogWrite(10, 523); }
      

Serial.println("Playing note 2!");
      if (chordN2 == 1){ tone(12, 262); }
      else if (chordN2 == 2){  tone(12, 294); }
      else if (chordN2 == 3){  tone(12, 330); }
      else if (chordN2 == 4){  tone(12, 349); }
      else if (chordN2 == 5){  tone(12, 392); }
      else if (chordN2 == 6){  tone(12, 440); }
      else if (chordN2 == 7){  tone(12, 493); }
      else if (chordN2 == 8){  tone(12, 523); }
  } // end of while 
      
    } // end of chord 

///////////////////////////////////////////////////////////////////////////////////////////////////


int buzzerPin = 10;
int buzzerPin2 = 12; 
int buttonState = 0; 

Button button1(2, 262, 500);
Button button2(3, 294, 500);
Button button3(4, 330, 500);
Button button4(5, 349, 500);
Button button5(6, 392, 500);
Button button6(7, 440, 500);
Button button7(8, 493, 500);
Button button8(9, 523, 500);

void setup() {
 Serial.begin(9600);                // initialize serial
 pinMode(buzzerPin, OUTPUT);       // set arduino pin to output mode
 pinMode(buzzerPin2, OUTPUT);
}

void loop() {
  button1.playNoise(2, 10, 262, 500);
  button2.playNoise(3, 10, 294, 500);
  button3.playNoise(4, 10, 330, 500);
  button4.playNoise(5, 10, 349, 500);
  button5.playNoise(6, 10, 392, 500);
  button6.playNoise(7, 10, 440, 500);
  button7.playNoise(8, 10, 493, 500);
  button8.playNoise(9, 10, 523, 500);


//Playing 2 Notes at Once: 
int chordN1; 
int chordN2; 

 int pushed [8] = {digitalRead(2), digitalRead(3), digitalRead(4), digitalRead(5), digitalRead(6), digitalRead(7), digitalRead(8), digitalRead(9)};//creates an array to hold the states of each button 

    for (int i = 1; i<=8; i++){ //will go through and read the arrays values 
     int pushedState = digitalRead(pushed[i]); //will read read every value in the array, and store it in a variable i   
     for (int j = 1; j <=8; j++){
      int compareState = digitalRead(pushed[j]); //will also read every value in the array, and store it in a new variable, j 
        if (pushedState == HIGH && compareState == HIGH && j != i){
          Serial.println("Two buttons pressed");
          //if there are 2 buttons pressed 
          chordN1 = i; 
          chordN2 = j; 
          playChord(chordN1, chordN2); }
     } // end of for 2 
}// end of for 1

}//end of void loop

</code></pre> 

## Files and Relevant Tutorials:

Laser Cutting File: </br>
 [DXF File](https://a360.co/3PApYHY).
</br>
 [DXF Addition File (to correct mistakes in the first cut)](https://a360.co/3oyetF5).


Playing Two Notes at Once: </br>
 [Arduino Tutorial](https://arduino.stackexchange.com/questions/32926/multiple-tones-with-one-piezo-buzzer).



</xmp>
</body>

<script src="https://strapdownjs.com/v/0.2/strapdown.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" ></script>

</html>